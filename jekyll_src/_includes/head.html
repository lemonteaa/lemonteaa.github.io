<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}</title>
  <meta name="description" content="{{ page.excerpt | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">

  <link rel="stylesheet" href="{{ "/assets/main.css" | relative_url }}">
  <link rel="canonical" href="{{ page.url | replace:'index.html','' | absolute_url }}">
  <link rel="alternate" type="application/rss+xml" title="{{ site.title | escape }}" href="{{ "/feed.xml" | relative_url }}">
  
  {% if page.math or layout.math %}
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  {% endif %}
  {% if jekyll.environment == 'production' and site.google_analytics %}
  {% include google-analytics.html %}
  {% endif %}
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.6/cookieconsent.min.css" />
  <script src="/assets/cookieconsent.min.js"></script>
  <script type="text/javascript">
  var startedDisqus = false;
  function storageAvailable(type) {
      try {
          var storage = window[type],
              x = '__storage_test__';
          storage.setItem(x, x);
          storage.removeItem(x);
          return true;
      }
      catch(e) {
          return e instanceof DOMException && (
              // everything except Firefox
              e.code === 22 ||
              // Firefox
              e.code === 1014 ||
              // test name field too, because code might not be present
              // everything except Firefox
              e.name === 'QuotaExceededError' ||
              // Firefox
              e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&
              // acknowledge QuotaExceededError only if there's something already stored
              storage.length !== 0;
      }
  }
  function startDisqus() {
      console.log("Starting Disqus...");
      startedDisqus = true;
  }
  
  window.addEventListener("load", function(){
    //Detect localStorage and polyfill if not supported
    if (!storageAvailable('localStorage')) {
      console.log("Local Storage not supported, fallback");
      window.localStorage = {
        _data: {},
        getItem: function(k) { return this._data.hasOwnProperty(k) ? this._data[k] : undefined; },
        setItem: function(k, v) { this._data[k] = v; },
        removeItem: function(k) { delete this._data[k]; }
      };
    }
  	    window.cookieconsent.initialise({
          "palette": {
            "popup": {
              "background": "#eaf7f7",
              "text": "#5c7291"
            },
            "button": {
              "background": "#56cbdb",
              "text": "#ffffff"
            }
          },
          //"position": "bottom-left",
          "revokable": true,
          "law": { regionalLaw: true, countryCode: 'UK' },
          "revokeBtn": '<div class=\'cc-revoke \{\{classes\}\}\'>Clear Privacy Settings</div>',
          "compliance": { "opt-in": '<div class=\'cc-compliance cc-highlight\'>\{\{deny\}\}\{\{allow\}\}</div>' },
          "type": "opt-in",
          "content": {
            "message": "This website uses Disqus for comments and discussions.",
        	"link": "Privacy Policy",
        	"href": "http://cookiesandyou.com",
            "deny": "Disable",
            "allow": "Enable Disqus"
          },
          "cookie": { "name": "consentDisqus" },
          "onStatusChange": function(status, chosenBefore) {
            if (status === 'allow') {
              if (!startedDisqus) {
                startDisqus();
              }
            } else if (status === 'deny') {
              if (startedDisqus) {
                alert("You have revoked consent for Disqus. Please refresh the page for it to take effect.");
              }
        	}
          },
          "onInitialise": function(status) {
            if (status === 'allow') { startDisqus(); }
            setTimeout(function(){document.getElementsByClassName("cc-revoke")[0].style.display = "block";});
          }
        });
  });
  </script>

</head>
